import"./style-6fJ1xWKc.js";const f=document.getElementById("merge-form"),o=document.getElementById("merge-status"),r=document.getElementById("merge-submit"),s=f.elements.model,m=document.getElementById("merge-file-chip"),a=f.querySelector(".uploader");let l=null;["dragenter","dragover","dragleave","drop"].forEach(t=>{a.addEventListener(t,e=>{e.preventDefault(),e.stopPropagation()})});["dragenter","dragover"].forEach(t=>{a.addEventListener(t,()=>a.classList.add("dragover"))});["dragleave","drop"].forEach(t=>{a.addEventListener(t,()=>a.classList.remove("dragover"))});a.addEventListener("drop",t=>{const e=new DataTransfer;Array.from(t.dataTransfer.files||[]).forEach(n=>{n.name.toLowerCase().endsWith(".glb")&&e.items.add(n)}),e.files.length&&(s.files=e.files,b(s.files[0]),u())});function b(t){if(m.innerHTML="",!t){m.innerHTML='<span class="chip">No file selected</span>';return}const e=document.createElement("span");e.className="chip",e.textContent=t.name,m.appendChild(e)}function u(){r.type="submit",r.textContent="Merge Meshes",r.disabled=!1,r.onclick=null}function y(t,e){r.type="button",r.disabled=!1,r.textContent="Download merged GLB",r.onclick=()=>{const n=document.createElement("a");n.href=t,n.download=e||"merged.glb",n.click()}}f.addEventListener("submit",async t=>{if(t.preventDefault(),o.className="status",o.textContent="",r.disabled=!0,r.textContent="Processing...",!s.files.length){o.textContent="Please choose a GLB file.",o.classList.add("error"),u();return}try{l||(l=new Worker(new URL(""+new URL("mesh-merger-worker-CL68W2vg.js",import.meta.url).href,import.meta.url),{type:"module"}));const e=s.files[0],n=await new Promise((d,i)=>{const g=setTimeout(()=>i(new Error("Worker timed out")),12e4);l.onmessage=c=>{clearTimeout(g);const{error:p,glb:w}=c.data||{};if(p)return i(new Error(p));d({glb:w})},l.onerror=c=>{clearTimeout(g),i(c)},l.postMessage({file:e})}),h=Uint8Array.from(atob(n.glb),d=>d.charCodeAt(0)),E=new Blob([h],{type:"model/gltf-binary"}),L=URL.createObjectURL(E),v=(e.name.replace(/\.glb$/i,"")||"merged")+".merged.glb";o.textContent="Done.",o.classList.add("success"),y(L,v)}catch(e){o.textContent=`Error: ${e.message}`,o.classList.add("error"),u()}});s.addEventListener("change",()=>b(s.files[0]));
